(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Zsgj/SaleGuide/FyList/FyDetails/FyDetails"],{"4b25":function(o,e,t){"use strict";t.r(e);var i=t("aa40"),n=t("56f2");for(var s in n)["default"].indexOf(s)<0&&function(o){t.d(e,o,(function(){return n[o]}))}(s);t("fdc1");var r=t("828b"),a=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"4a6efa96",null,!1,i["a"],void 0);e["default"]=a.exports},"56f2":function(o,e,t){"use strict";t.r(e);var i=t("a9bf"),n=t.n(i);for(var s in i)["default"].indexOf(s)<0&&function(o){t.d(e,o,(function(){return i[o]}))}(s);e["default"]=n.a},"947d":function(o,e,t){"use strict";(function(o,e){var i=t("47a9");t("7ea0");i(t("3240"));var n=i(t("4b25"));o.__webpack_require_UNI_MP_PLUGIN__=t,e(n.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},a9bf:function(o,e,t){"use strict";(function(o){var i=t("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(t("7ca3")),s=t("7dcd"),r=null,a={data:function(){return(0,n.default)({commissionStatus:"",visible:!1,orderNo:"",business:"",guide:"",detls:{addressMap:{},commissionMap:{},orderDetailMap:{},orderMap:{orderNo:""}},jlList:{managerName:"",managerNo:"",managerAccount:""},dyList:{tourGuideName:"",tourGuideNo:"",tourGuideAccount:""},onlylook:1,role:"",popName:"",orgCode:"",index1:0,list1:[{orgName:"",orgCode:""}],list2:[{agName:"",agCode:""}],index2:0},"role","")},components:{},onShow:function(){this.queryCommissionInfoForBpm()},onLoad:function(o){r=this,console.log(o),this.commissionStatus=o.orderType,this.orderNo=o.orderNo,this.onlylook=o.onlylook,o.jlList&&(this.jlList=JSON.parse(o.jlList)),o.dyList&&(this.dyList=JSON.parse(o.dyList))},methods:{changePcikerYwd:function(o){console.log(o),this.index1=o.detail.value,this.list1&&r.queryOrgAgency(this.list1[this.index1].orgCode,2,0)},changePcikerJxs:function(o){this.index2=o.detail.value},queryCommissionInfoForBpm:function(){var e=o.getStorageSync("basicData"),t=JSON.parse(e);this.role=t.role;var i={orderNo:r.orderNo,sid:t.sid,role:t.role};(0,s.queryCommissionInfoForBpm)(i).then((function(o){r.detls=o,"待确认"==r.detls.commissionMap.commissionStatus&&3==r.role&&r.queryOrgAgency("",1,1),"待登记"==o.commissionMap.commissionStatus&&0==r.onlylook&&r.open()})).catch((function(e){o.showToast({title:e.data.msg||"queryCommissionInfoForBpm接口异常,请稍后再试",icon:"none"})}))},queryOrgAgency:function(e,t,i){var n=this,a=o.getStorageSync("basicData"),u=JSON.parse(a);this.role=u.role;var l={orderNo:r.orderNo,sid:u.sid,role:u.role,pageSize:100,pageNo:1,empCode:r.detls.commissionMap.managerNo,orgCode:e,queryType:t};(0,s.queryOrgAgency)(l).then((function(e){0!=e.resultList.length&&e.resultList?1==t?(r.list1=e.resultList,1==i&&r.list1.length>0&&r.queryOrgAgency(n.list1[0].orgCode,2,0)):r.list2=e.resultList:o.showToast({title:1==t?"未查询到所属业务点":"未查询到所属经销商",icon:"none",duration:3e3})})).catch((function(e){o.showToast({title:e.data.msg||"queryOrgAgency接口异常,请稍后再试",icon:"none"})}))},back:function(){o.navigateBack()},open:function(){this.$refs.popup.open("bottom")},close:function(){this.$refs.popup.close()},selectRy:function(e){"导游"==e?o.redirectTo({url:"/pages/Zsgj/PList/GuideList/GuideList?from=/pages/Zsgj/SaleGuide/FyList/FyDetails/FyDetails&onlylook=0&cz=分佣登记&orderNo="+this.orderNo+"&jlList="+JSON.stringify(this.jlList)}):o.redirectTo({url:"/pages/Zsgj/PList/ManagerList/ManagerList?from=/pages/Zsgj/SaleGuide/FyList/FyDetails/FyDetails&onlylook=0&cz=分佣登记&orderNo="+this.orderNo+"&dyList="+JSON.stringify(this.dyList)})},fysave:function(){var e=o.getStorageSync("basicData"),t=JSON.parse(e);if(""==r.jlList.managerName)return o.showToast({title:"请选择厂方人员",icon:"none"}),!1;var i={orderNo:r.detls.orderMap.orderNo,sid:t.sid,role:t.role,tourGuideName:r.dyList.tourGuideName,tourGuideNo:r.dyList.tourGuideNo,tourGuideAccount:r.dyList.tourGuideAccount,managerName:r.jlList.managerName,managerNo:r.jlList.managerNo,managerAccount:r.jlList.managerAccount};(0,s.registerCommissionForBpm)(i).then((function(e){o.showToast({title:"登记成功",duration:2e3});var t=setTimeout((function(){r.close(),r.queryCommissionInfoForBpm(),clearTimeout(t)}),1500)})).catch((function(e){o.showToast({title:e.data.msg||"registerCommissionForBpm接口异常,请稍后再试",icon:"none"})}))},confirm:function(){if(0!=r.list1.length&&""!=r.list1[0].orgName)if(0!=r.list2.length&&""!=r.list2[0].agName){console.log(r.list1[r.index1].orgName+r.list1[r.index1].orgCode),console.log(r.list2[r.index2].agName+r.list2[r.index2].agCode);var e=o.getStorageSync("basicData"),t=JSON.parse(e);this.role=t.role;var i={orderNo:r.orderNo,sid:t.sid,role:t.role,businessPointNo:r.list1[r.index1].orgCode,businessPoint:r.list1[r.index1].orgName,dealerNo:r.list2[r.index2].agCode,dealerName:r.list2[r.index2].agName};(0,s.confirmCommissionForBpm)(i).then((function(e){o.showToast({title:"确认成功",duration:2e3});var t=setTimeout((function(){r.close(),r.queryCommissionInfoForBpm(),clearTimeout(t)}),1500)})).catch((function(e){o.showToast({title:e.data.msg||"confirmCommissionForBpm接口异常,请稍后再试",icon:"none"})}))}else o.showToast({title:"未查询到所属经销商，请联系管理员",icon:"none"});else o.showToast({title:"未查询到所属业务点，请联系管理员",icon:"none"})}}};e.default=a}).call(this,t("df3c")["default"])},aa40:function(o,e,t){"use strict";t.d(e,"b",(function(){return n})),t.d(e,"c",(function(){return s})),t.d(e,"a",(function(){return i}));var i={uniIcons:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(t.bind(null,"7eb3"))},uniPopup:function(){return t.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(t.bind(null,"d9a0"))}},n=function(){var o=this.$createElement,e=(this._self._c,t("3289")),i=t("3289");this.$mp.data=Object.assign({},{$root:{m0:e,m1:i}})},s=[]},d0ee:function(o,e,t){},fdc1:function(o,e,t){"use strict";var i=t("d0ee"),n=t.n(i);n.a}},[["947d","common/runtime","common/vendor"]]]);